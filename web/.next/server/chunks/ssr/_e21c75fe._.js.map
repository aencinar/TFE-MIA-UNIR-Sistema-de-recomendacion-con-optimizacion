{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/aencinar/Downloads/TFE-Sistema-de-recomendacion-de-productos-master/web/app/hooks/useProductCatalog.ts"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { Product, Category } from \"@/types\";\n\nconst CATEGORY_MAP: { [key: number]: string } = {\n  1: \"Aceite\", 2: \"Vinagre\", 3: \"Sal\", 4: \"Especias\", 5: \"Salsas\",\n  6: \"Bebidas sin alcohol\", 7: \"Bebidas con alcohol\", 8: \"Aperitivos\", 9: \"Arroz\", 10: \"Legumbre\",\n  11: \"Pasta\", 12: \"Dulces y pastelería\", 13: \"Comida preparada\", 14: \"Cacao, café, infusiones\",\n  15: \"Carne\", 16: \"Pescado\", 17: \"Cereales\", 18: \"Galletas\", 19: \"Charcutería\",\n  20: \"Quesos\", 21: \"Congelados\", 22: \"Conservas\", 23: \"Caldos y sopas\", 24: \"Cremas\",\n  25: \"Fruta\", 26: \"Verduras\", 27: \"Ensaladas\", 28: \"Huevos\", 29: \"Lácteos\",\n  30: \"Panadería\", 31: \"Pizzas\", 32: \"Zumos\", 33: \"Bicarbonato\", 34: \"Sazonador\", 35: \"Harina y masas\",\n  36: \"Comida mexicana\", 37: \"Comida oriental\", 38: \"Otros\", 39: \"Azúcar, edulcorantes, otros\",\n  40: \"Mermelada, membrillo, miel, otros\"\n};\n\nexport function useProductCatalog(selectedCategories: number[], selectedRestrictions: string[], page: number) {\n  const [catalog, setCatalog] = useState<Product[]>([]);\n  const [categories, setCategories] = useState<Category[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const apiUrl = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8000\";\n    setLoading(true);\n\n    const params = new URLSearchParams();\n    selectedCategories.forEach(cat => params.append(\"categories\", String(cat)));\n    selectedRestrictions.forEach(r => params.append(\"restrictions\", r));\n    params.append(\"page\", String(page || 1));\n\n    fetch(`${apiUrl}/api/catalog?${params.toString()}`)\n      .then(res => res.json())\n      .then(data => {\n        setCatalog(data.products.map((p: any) => ({\n          ...p,\n          id: p.id ?? p.product_code ?? p._id ?? Math.random(),\n          categoryId: p.category\n        })));\n      })\n      .finally(() => setLoading(false));\n\n    setCategories(\n      Object.entries(CATEGORY_MAP).map(([id, name]) => ({\n        id: Number(id),\n        name\n      }))\n    );\n  }, [selectedCategories, selectedRestrictions, page]);\n\n  return { catalog, categories, loading };\n}\n"],"names":[],"mappings":";;;AAAA;;AAGA,MAAM,eAA0C;IAC9C,GAAG;IAAU,GAAG;IAAW,GAAG;IAAO,GAAG;IAAY,GAAG;IACvD,GAAG;IAAuB,GAAG;IAAuB,GAAG;IAAc,GAAG;IAAS,IAAI;IACrF,IAAI;IAAS,IAAI;IAAuB,IAAI;IAAoB,IAAI;IACpE,IAAI;IAAS,IAAI;IAAW,IAAI;IAAY,IAAI;IAAY,IAAI;IAChE,IAAI;IAAU,IAAI;IAAc,IAAI;IAAa,IAAI;IAAkB,IAAI;IAC3E,IAAI;IAAS,IAAI;IAAY,IAAI;IAAa,IAAI;IAAU,IAAI;IAChE,IAAI;IAAa,IAAI;IAAU,IAAI;IAAS,IAAI;IAAe,IAAI;IAAa,IAAI;IACpF,IAAI;IAAmB,IAAI;IAAmB,IAAI;IAAS,IAAI;IAC/D,IAAI;AACN;AAEO,SAAS,kBAAkB,kBAA4B,EAAE,oBAA8B,EAAE,IAAY;IAC1G,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACpD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAc,EAAE;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,SAAS,QAAQ,GAAG,CAAC,mBAAmB,IAAI;QAClD,WAAW;QAEX,MAAM,SAAS,IAAI;QACnB,mBAAmB,OAAO,CAAC,CAAA,MAAO,OAAO,MAAM,CAAC,cAAc,OAAO;QACrE,qBAAqB,OAAO,CAAC,CAAA,IAAK,OAAO,MAAM,CAAC,gBAAgB;QAChE,OAAO,MAAM,CAAC,QAAQ,OAAO,QAAQ;QAErC,MAAM,GAAG,OAAO,aAAa,EAAE,OAAO,QAAQ,IAAI,EAC/C,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI,IACpB,IAAI,CAAC,CAAA;YACJ,WAAW,KAAK,QAAQ,CAAC,GAAG,CAAC,CAAC,IAAW,CAAC;oBACxC,GAAG,CAAC;oBACJ,IAAI,EAAE,EAAE,IAAI,EAAE,YAAY,IAAI,EAAE,GAAG,IAAI,KAAK,MAAM;oBAClD,YAAY,EAAE,QAAQ;gBACxB,CAAC;QACH,GACC,OAAO,CAAC,IAAM,WAAW;QAE5B,cACE,OAAO,OAAO,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,IAAI,KAAK,GAAK,CAAC;gBAChD,IAAI,OAAO;gBACX;YACF,CAAC;IAEL,GAAG;QAAC;QAAoB;QAAsB;KAAK;IAEnD,OAAO;QAAE;QAAS;QAAY;IAAQ;AACxC","debugId":null}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///Users/aencinar/Downloads/TFE-Sistema-de-recomendacion-de-productos-master/web/app/hooks/useRecommendation.ts"],"sourcesContent":["import { useState } from \"react\";\nimport { UserListItem } from \"@/types\";\n\nexport function useRecommendation(userList: UserListItem[], budget: number | '') {\n  const [show, setShow] = useState(false);\n  const [recommendation, setRecommendation] = useState<UserListItem[] | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  async function fetchRecommendation() {\n    setLoading(true);\n    setShow(true);\n    try {\n      const res = await fetch(\"/api/recommendation\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          products: userList,\n          budget: budget === \"\" ? null : Number(budget)\n        }),\n      });\n      const data = await res.json();\n      setRecommendation(\n        data.products.map((p: any) => ({\n          ...p,\n          id: p.id ?? p.product_code ?? p._id ?? Math.random(),\n          categoryId: p.category\n        }))\n      );\n    } catch {\n      setRecommendation([]);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return {\n    show,\n    setShow,\n    recommendation,\n    setRecommendation,\n    loading,\n    fetchRecommendation,\n  };\n}\n"],"names":[],"mappings":";;;AAAA;;AAGO,SAAS,kBAAkB,QAAwB,EAAE,MAAmB;IAC7E,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAyB;IAC5E,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,eAAe;QACb,WAAW;QACX,QAAQ;QACR,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,uBAAuB;gBAC7C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB,UAAU;oBACV,QAAQ,WAAW,KAAK,OAAO,OAAO;gBACxC;YACF;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,kBACE,KAAK,QAAQ,CAAC,GAAG,CAAC,CAAC,IAAW,CAAC;oBAC7B,GAAG,CAAC;oBACJ,IAAI,EAAE,EAAE,IAAI,EAAE,YAAY,IAAI,EAAE,GAAG,IAAI,KAAK,MAAM;oBAClD,YAAY,EAAE,QAAQ;gBACxB,CAAC;QAEL,EAAE,OAAM;YACN,kBAAkB,EAAE;QACtB,SAAU;YACR,WAAW;QACb;IACF;IAEA,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;IACF;AACF","debugId":null}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file:///Users/aencinar/Downloads/TFE-Sistema-de-recomendacion-de-productos-master/web/app/components/ProductCard.tsx"],"sourcesContent":["import { Product } from \"@/types\";\n\ntype Props = {\n  product: Product;\n  onAdd: (product: Product) => void;\n};\n\nexport default function ProductCard({ product, onAdd }: Props) {\n  return (\n    <div className=\"bg-white rounded-2xl shadow-md hover:shadow-lg p-5 flex flex-col justify-between\">\n      <span className=\"font-semibold text-lg mb-2\">{product.name}</span>\n      <span className=\"text-xs text-gray-500 mb-2\">{product.category}</span>\n      <div className=\"flex gap-2 flex-wrap mb-4\">\n        <span className=\"bg-orange-100 text-orange-700 text-xs px-2 py-0.5 rounded\">{product.subcategory}</span>\n      </div>\n      <span className=\"font-bold mb-2 text-orange-700\">\n        €{product.price?.toFixed(2) ?? \"-\"}\n      </span>\n      <button\n        className=\"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded font-bold mt-auto\"\n        onClick={() => onAdd(product)}\n      >Añadir a mi lista</button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAOe,SAAS,YAAY,EAAE,OAAO,EAAE,KAAK,EAAS;IAC3D,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAK,WAAU;0BAA8B,QAAQ,IAAI;;;;;;0BAC1D,8OAAC;gBAAK,WAAU;0BAA8B,QAAQ,QAAQ;;;;;;0BAC9D,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAK,WAAU;8BAA6D,QAAQ,WAAW;;;;;;;;;;;0BAElG,8OAAC;gBAAK,WAAU;;oBAAiC;oBAC7C,QAAQ,KAAK,EAAE,QAAQ,MAAM;;;;;;;0BAEjC,8OAAC;gBACC,WAAU;gBACV,SAAS,IAAM,MAAM;0BACtB;;;;;;;;;;;;AAGP","debugId":null}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":["file:///Users/aencinar/Downloads/TFE-Sistema-de-recomendacion-de-productos-master/web/app/components/UserList.tsx"],"sourcesContent":["import { UserListItem } from \"@/types\";\n\ntype Props = {\n  userList: UserListItem[];\n  onAdd: (item: UserListItem) => void;\n  onRemove: (idx: number) => void;\n  total: number;\n  budget: number | '';\n  sending: boolean;\n  onSend: () => void;\n  onRecommend: () => void;\n};\n\nexport default function UserList({ userList, onAdd, onRemove, total, budget, sending, onSend, onRecommend }: Props) {\n  return (\n    <div>\n      <h3 className=\"font-bold mb-2 text-lg text-orange-700\">Mi lista</h3>\n      <ul>\n        {userList.map((item, idx) => (\n          <li key={item.id} className=\"flex justify-between items-center py-1 border-b last:border-0\">\n            <span>\n              {item.name}\n              <span className=\"ml-2 text-xs text-gray-500\">x{item.quantity}</span>\n              <span className=\"ml-2 text-orange-600 text-xs\">€{(item.price * item.quantity).toFixed(2)}</span>\n            </span>\n            <div className=\"flex gap-1\">\n              <button\n                className=\"text-orange-600 border px-1 rounded hover:bg-orange-100\"\n                onClick={() => onAdd(item)}\n                title=\"Añadir uno más\"\n              >+</button>\n              <button\n                className=\"text-red-500 hover:text-red-700 text-xs\"\n                onClick={() => onRemove(idx)}\n              >Quitar</button>\n            </div>\n          </li>\n        ))}\n      </ul>\n      <div className=\"font-bold mt-2\">\n        Total: <span className={budget && total > Number(budget) ? \"text-red-600\" : \"text-green-700\"}>\n          €{total.toFixed(2)}\n        </span>\n        {budget && total > Number(budget) && (\n          <span className=\"ml-2 text-xs text-red-600\">¡Supera el presupuesto!</span>\n        )}\n      </div>\n      <button\n        className={`w-full mt-4 px-4 py-2 rounded-lg font-bold transition ${\n          userList.length === 0 || sending\n            ? \"bg-gray-300 text-gray-400 cursor-not-allowed\"\n            : \"bg-orange-600 text-white hover:bg-orange-700\"\n        }`}\n        disabled={userList.length === 0 || sending}\n        onClick={onSend}\n      >\n        {sending ? \"Enviando...\" : \"Enviar lista\"}\n      </button>\n      <button\n        className=\"w-full mt-2 px-4 py-2 rounded-lg font-bold bg-indigo-600 text-white hover:bg-indigo-700 transition\"\n        disabled={userList.length === 0}\n        onClick={onRecommend}\n      >\n        Recomendar lista óptima IA\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAae,SAAS,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,WAAW,EAAS;IAChH,qBACE,8OAAC;;0BACC,8OAAC;gBAAG,WAAU;0BAAyC;;;;;;0BACvD,8OAAC;0BACE,SAAS,GAAG,CAAC,CAAC,MAAM,oBACnB,8OAAC;wBAAiB,WAAU;;0CAC1B,8OAAC;;oCACE,KAAK,IAAI;kDACV,8OAAC;wCAAK,WAAU;;4CAA6B;4CAAE,KAAK,QAAQ;;;;;;;kDAC5D,8OAAC;wCAAK,WAAU;;4CAA+B;4CAAE,CAAC,KAAK,KAAK,GAAG,KAAK,QAAQ,EAAE,OAAO,CAAC;;;;;;;;;;;;;0CAExF,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCACC,WAAU;wCACV,SAAS,IAAM,MAAM;wCACrB,OAAM;kDACP;;;;;;kDACD,8OAAC;wCACC,WAAU;wCACV,SAAS,IAAM,SAAS;kDACzB;;;;;;;;;;;;;uBAfI,KAAK,EAAE;;;;;;;;;;0BAoBpB,8OAAC;gBAAI,WAAU;;oBAAiB;kCACvB,8OAAC;wBAAK,WAAW,UAAU,QAAQ,OAAO,UAAU,iBAAiB;;4BAAkB;4BAC1F,MAAM,OAAO,CAAC;;;;;;;oBAEjB,UAAU,QAAQ,OAAO,yBACxB,8OAAC;wBAAK,WAAU;kCAA4B;;;;;;;;;;;;0BAGhD,8OAAC;gBACC,WAAW,CAAC,sDAAsD,EAChE,SAAS,MAAM,KAAK,KAAK,UACrB,iDACA,gDACJ;gBACF,UAAU,SAAS,MAAM,KAAK,KAAK;gBACnC,SAAS;0BAER,UAAU,gBAAgB;;;;;;0BAE7B,8OAAC;gBACC,WAAU;gBACV,UAAU,SAAS,MAAM,KAAK;gBAC9B,SAAS;0BACV;;;;;;;;;;;;AAKP","debugId":null}},
    {"offset": {"line": 368, "column": 0}, "map": {"version":3,"sources":["file:///Users/aencinar/Downloads/TFE-Sistema-de-recomendacion-de-productos-master/web/app/components/RecommendationModal.tsx"],"sourcesContent":["import { UserListItem } from \"@/types\";\n\ntype Props = {\n  show: boolean;\n  onClose: () => void;\n  loading: boolean;\n  recommendation: UserListItem[] | null;\n  onAccept: () => void;\n  onReject: () => void;\n};\n\nexport default function RecommendationModal({ show, onClose, loading, recommendation, onAccept, onReject }: Props) {\n  if (!show) return null;\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\">\n      <div className=\"bg-white rounded-2xl shadow-xl max-w-lg w-full p-6 relative\">\n        <button\n          className=\"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-xl\"\n          onClick={onClose}\n          aria-label=\"Cerrar\"\n        >×</button>\n        <h2 className=\"text-2xl font-bold mb-4 text-orange-700\">Lista recomendada por IA</h2>\n        {loading ? (\n          <div className=\"flex flex-col items-center py-12\">\n            <div className=\"w-10 h-10 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mb-4\"></div>\n            <div className=\"text-orange-700 text-lg font-semibold animate-pulse\">Calculando recomendación...</div>\n          </div>\n        ) : recommendation && recommendation.length > 0 ? (\n          <>\n            <ul className=\"mb-4 max-h-52 overflow-y-auto\">\n              {recommendation.map((item, idx) => (\n                <li key={item.id} className=\"flex justify-between py-2 border-b last:border-0\">\n                  <span>\n                    {item.name}\n                    <span className=\"ml-2 text-xs text-gray-500\">x{item.quantity}</span>\n                    <span className=\"ml-2 text-orange-600 text-xs\">€{(item.price * item.quantity).toFixed(2)}</span>\n                  </span>\n                </li>\n              ))}\n            </ul>\n            <div className=\"font-bold mb-3\">\n              Total recomendado: <span className=\"text-green-700\">\n                €{recommendation.reduce((sum, i) => sum + (i.price || 0) * i.quantity, 0).toFixed(2)}\n              </span>\n            </div>\n            <div className=\"flex gap-4\">\n              <button\n                className=\"bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded font-bold\"\n                onClick={onAccept}\n              >Aceptar</button>\n              <button\n                className=\"bg-gray-400 hover:bg-gray-600 text-white px-5 py-2 rounded font-bold\"\n                onClick={onReject}\n              >Rechazar y ver otra</button>\n            </div>\n          </>\n        ) : (\n          <div className=\"text-gray-500 text-center\">No hay una recomendación disponible.</div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAWe,SAAS,oBAAoB,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,cAAc,EAAE,QAAQ,EAAE,QAAQ,EAAS;IAC/G,IAAI,CAAC,MAAM,OAAO;IAClB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBACC,WAAU;oBACV,SAAS;oBACT,cAAW;8BACZ;;;;;;8BACD,8OAAC;oBAAG,WAAU;8BAA0C;;;;;;gBACvD,wBACC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;;;;;sCACf,8OAAC;4BAAI,WAAU;sCAAsD;;;;;;;;;;;2BAErE,kBAAkB,eAAe,MAAM,GAAG,kBAC5C;;sCACE,8OAAC;4BAAG,WAAU;sCACX,eAAe,GAAG,CAAC,CAAC,MAAM,oBACzB,8OAAC;oCAAiB,WAAU;8CAC1B,cAAA,8OAAC;;4CACE,KAAK,IAAI;0DACV,8OAAC;gDAAK,WAAU;;oDAA6B;oDAAE,KAAK,QAAQ;;;;;;;0DAC5D,8OAAC;gDAAK,WAAU;;oDAA+B;oDAAE,CAAC,KAAK,KAAK,GAAG,KAAK,QAAQ,EAAE,OAAO,CAAC;;;;;;;;;;;;;mCAJjF,KAAK,EAAE;;;;;;;;;;sCASpB,8OAAC;4BAAI,WAAU;;gCAAiB;8CACX,8OAAC;oCAAK,WAAU;;wCAAiB;wCAChD,eAAe,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,CAAC,EAAE,KAAK,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,GAAG,OAAO,CAAC;;;;;;;;;;;;;sCAGtF,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,WAAU;oCACV,SAAS;8CACV;;;;;;8CACD,8OAAC;oCACC,WAAU;oCACV,SAAS;8CACV;;;;;;;;;;;;;iDAIL,8OAAC;oBAAI,WAAU;8BAA4B;;;;;;;;;;;;;;;;;AAKrD","debugId":null}},
    {"offset": {"line": 543, "column": 0}, "map": {"version":3,"sources":["file:///Users/aencinar/Downloads/TFE-Sistema-de-recomendacion-de-productos-master/web/app/shopping-list/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from \"react\";\nimport { Product, UserListItem } from \"@/types\";\nimport { useProductCatalog } from \"@/hooks/useProductCatalog\";\nimport { useRecommendation } from \"@/hooks/useRecommendation\";\nimport ProductCard from \"@/components/ProductCard\";\nimport UserList from \"@/components/UserList\";\nimport RecommendationModal from \"@/components/RecommendationModal\";\n\nconst PAGE_SIZE = 40;\n\nexport default function ProductCatalogWithSidebar() {\n  const [selectedCategories, setSelectedCategories] = useState<number[]>([]);\n  const [selectedRestrictions, setSelectedRestrictions] = useState<string[]>([]);\n  const [search, setSearch] = useState(\"\");\n  const [userList, setUserList] = useState<UserListItem[]>([]);\n  const [visibleCount, setVisibleCount] = useState(PAGE_SIZE);\n  const [page, setPage] = useState(1);\n  const [budget, setBudget] = useState<number | ''>('');\n  const [sending, setSending] = useState(false);\n\n  const { catalog, categories, loading } = useProductCatalog(selectedCategories, selectedRestrictions, page);\n\n  // -------- Modal Recomendación IA --------\n  const rec = useRecommendation(userList, budget);\n\n  // ... aquí la lógica add/remove igual que antes ...\n\n  // Add product to list\n  function addToList(product: Product) {\n    setUserList(list => {\n      const idx = list.findIndex(item => item.id === product.id);\n      if (idx > -1) {\n        return list.map((item, i) =>\n          i === idx ? { ...item, quantity: item.quantity + 1 } : item\n        );\n      }\n      return [...list, { ...product, quantity: 1 }];\n    });\n  }\n  function removeFromList(idx: number) {\n    setUserList(list => {\n      if (list[idx].quantity > 1) {\n        return list.map((item, i) =>\n          i === idx ? { ...item, quantity: item.quantity - 1 } : item\n        );\n      }\n      return list.filter((_, i) => i !== idx);\n    });\n  }\n\n  // Lógica de filtrado y total\n  const filteredCatalog = catalog.filter(p =>\n    search.trim() === \"\" || p.name.toLowerCase().includes(search.trim().toLowerCase())\n  );\n  const visibleProducts = filteredCatalog.slice(0, visibleCount);\n  const total = userList.reduce((sum, item) => sum + (item.price || 0) * item.quantity, 0);\n\n  function handleSend() {\n    setSending(true);\n    fetch(\"/api/send-shopping-list\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        products: userList,\n        budget: budget === \"\" ? null : Number(budget),\n        total\n      }),\n    })\n      .then(res => {\n        if (res.ok) {\n          alert(\"¡Lista enviada correctamente!\");\n          setUserList([]);\n        } else {\n          alert(\"Error al enviar la lista\");\n        }\n      })\n      .catch(() => alert(\"Error de red al enviar la lista\"))\n      .finally(() => setSending(false));\n  }\n\n  return (\n    <div className=\"flex w-full min-h-screen bg-gray-50\">\n      {/* --- SIDEBAR --- */}\n      <aside className=\"w-72 bg-white shadow-lg p-6 flex flex-col gap-8\">\n        {/* ...inputs y filtros... */}\n        <UserList\n          userList={userList}\n          onAdd={item => addToList(item)}\n          onRemove={removeFromList}\n          total={total}\n          budget={budget}\n          sending={sending}\n          onSend={handleSend}\n          onRecommend={rec.fetchRecommendation}\n        />\n      </aside>\n\n      {/* --- GRID DE PRODUCTOS --- */}\n      <main className=\"flex-1 p-10\">\n        <h2 className=\"text-2xl font-bold text-orange-700 mb-4\">Catálogo de productos</h2>\n        {loading ? (\n          <div className=\"flex flex-col items-center justify-center h-64\">\n            <div className=\"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mb-4\"></div>\n            <div className=\"text-orange-700 text-lg font-semibold animate-pulse\">Cargando productos...</div>\n          </div>\n        ) : (\n          <>\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-7\">\n              {visibleProducts.map(product => (\n                <ProductCard\n                  key={product.id}\n                  product={product}\n                  onAdd={addToList}\n                />\n              ))}\n            </div>\n            {/* Botón \"Cargar más\" */}\n            {visibleCount < filteredCatalog.length && (\n              <div className=\"flex justify-center mt-8\">\n                <button\n                  className=\"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg shadow font-bold\"\n                  onClick={() => setVisibleCount(count => Math.min(count + PAGE_SIZE, filteredCatalog.length))}\n                >\n                  Cargar más productos\n                </button>\n              </div>\n            )}\n            {filteredCatalog.length === 0 && (\n              <div className=\"text-gray-400 text-center my-12\">\n                No hay productos que cumplan los filtros seleccionados.\n              </div>\n            )}\n          </>\n        )}\n      </main>\n\n      {/* --- MODAL RECOMENDACIÓN --- */}\n      <RecommendationModal\n        show={rec.show}\n        onClose={() => rec.setShow(false)}\n        loading={rec.loading}\n        recommendation={rec.recommendation}\n        onAccept={() => {\n          if (rec.recommendation) setUserList(rec.recommendation);\n          rec.setShow(false);\n        }}\n        onReject={rec.fetchRecommendation}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 764, "column": 0}, "map": {"version":3,"sources":["file:///Users/aencinar/Downloads/TFE-Sistema-de-recomendacion-de-productos-master/web/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored[\n  'react-ssr'\n].ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":";AAAAA,OAAOC,OAAO,GAAGC,QAAQ,4HAAyBC,QAAQ,CACxD,YACD,CAACC,kBAAkB","ignoreList":[0],"debugId":null}}]
}